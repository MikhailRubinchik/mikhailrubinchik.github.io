<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>C++ code colored by C++2HTML</title>
<meta name="generator" content="C++2HTML by Jasper Bedaux">
<!-- To generate your own colored code visit http://www.bedaux.net/cpp2html/ -->
<style type="text/css">
.comment { color: #999999; font-style: italic; }
.pre { color: #000099; }
.string { color: #009900; }
.char { color: #009900; }
.float { color: #996600; }
.int { color: #999900; }
.bool { color: #000000; font-weight: bold; }
.type { color: #FF6633; }
.flow { color: #FF0000; }
.keyword { color: #990000; }
.operator { color: #663300; font-weight: bold; }
.operator { color: #663300; font-weight: bold; }
</style>
</head>
<body>
<pre><span class="pre">#include &lt;bits/stdc++.h&gt;
</span><span class="keyword"> 
using namespace</span> std<span class="operator">;</span><span class="keyword">
 
const</span><span class="type"> int</span> maxn<span class="operator"> =</span><span class="float"> 3e5</span><span class="operator"> +</span><span class="int"> 1</span><span class="operator">,</span> sigma<span class="operator"> =</span><span class="int"> 26</span><span class="operator">;</span><span class="type">
int</span> len<span class="operator">[</span>maxn<span class="operator">],</span> link<span class="operator">[</span>maxn<span class="operator">],</span> to<span class="operator">[</span>maxn<span class="operator">][</span>sigma<span class="operator">];</span><span class="type">
int</span> slink<span class="operator">[</span>maxn<span class="operator">],</span> diff<span class="operator">[</span>maxn<span class="operator">],</span> series_ans<span class="operator">[</span>maxn<span class="operator">];</span><span class="type">
int</span> sz<span class="operator">,</span> last<span class="operator">,</span> n<span class="operator">;</span><span class="type">
char</span> s<span class="operator">[</span>maxn<span class="operator">];</span><span class="type">
 
void</span> init<span class="operator">()
{</span>
    s<span class="operator">[</span>n<span class="operator">++] = -</span><span class="int">1</span><span class="operator">;</span>
    link<span class="operator">[</span><span class="int">0</span><span class="operator">] =</span><span class="int"> 1</span><span class="operator">;</span>
    len<span class="operator">[</span><span class="int">1</span><span class="operator">] = -</span><span class="int">1</span><span class="operator">;</span>
    sz<span class="operator"> =</span><span class="int"> 2</span><span class="operator">;
}</span><span class="type">
 
int</span> get_link<span class="operator">(</span><span class="type">int</span> v<span class="operator">)
{</span><span class="flow">
    while</span><span class="operator">(</span>s<span class="operator">[</span>n<span class="operator"> -</span> len<span class="operator">[</span>v<span class="operator">] -</span><span class="int"> 2</span><span class="operator">] !=</span> s<span class="operator">[</span>n<span class="operator"> -</span><span class="int"> 1</span><span class="operator">])</span> v<span class="operator"> =</span> link<span class="operator">[</span>v<span class="operator">];</span><span class="flow">
    return</span> v<span class="operator">;
}</span><span class="type">
 
void</span> add_letter<span class="operator">(</span><span class="type">char</span> c<span class="operator">)
{</span>
    s<span class="operator">[</span>n<span class="operator">++] =</span> c<span class="operator"> -=</span><span class="char"> 'a'</span><span class="operator">;</span>
    last<span class="operator"> =</span> get_link<span class="operator">(</span>last<span class="operator">);</span><span class="flow">
    if</span><span class="operator">(!</span>to<span class="operator">[</span>last<span class="operator">][</span>c<span class="operator">])
    {</span>
        len<span class="operator">[</span>sz<span class="operator">] =</span> len<span class="operator">[</span>last<span class="operator">] +</span><span class="int"> 2</span><span class="operator">;</span>
        link<span class="operator">[</span>sz<span class="operator">] =</span> to<span class="operator">[</span>get_link<span class="operator">(</span>link<span class="operator">[</span>last<span class="operator">])][</span>c<span class="operator">];</span>
        diff<span class="operator">[</span>sz<span class="operator">] =</span> len<span class="operator">[</span>sz<span class="operator">] -</span> len<span class="operator">[</span>link<span class="operator">[</span>sz<span class="operator">]];</span><span class="flow">
        if</span><span class="operator">(</span>diff<span class="operator">[</span>sz<span class="operator">] ==</span> diff<span class="operator">[</span>link<span class="operator">[</span>sz<span class="operator">]])</span>
            slink<span class="operator">[</span>sz<span class="operator">] =</span> slink<span class="operator">[</span>link<span class="operator">[</span>sz<span class="operator">]];</span><span class="flow">
        else</span>
            slink<span class="operator">[</span>sz<span class="operator">] =</span> link<span class="operator">[</span>sz<span class="operator">];</span>
        to<span class="operator">[</span>last<span class="operator">][</span>c<span class="operator">] =</span> sz<span class="operator">++;
    }</span>
    last<span class="operator"> =</span> to<span class="operator">[</span>last<span class="operator">][</span>c<span class="operator">];
}</span><span class="type">
 
int</span><span class="keyword"> main</span><span class="operator">()
{</span>
    ios<span class="operator">::</span>sync_with_stdio<span class="operator">(</span><span class="int">0</span><span class="operator">);</span>
    cin<span class="operator">.</span>tie<span class="operator">(</span><span class="int">0</span><span class="operator">);</span>
    init<span class="operator">();</span>
    string s<span class="operator">;</span>
    cin<span class="operator"> &gt;&gt;</span> s<span class="operator">;</span><span class="type">
    int</span> n<span class="operator"> =</span> s<span class="operator">.</span>size<span class="operator">();</span><span class="type">
    int</span> ans<span class="operator">[</span>n<span class="operator"> +</span><span class="int"> 1</span><span class="operator">];</span>
    memset<span class="operator">(</span>ans<span class="operator">,</span><span class="int"> 63</span><span class="operator">,</span><span class="keyword"> sizeof</span><span class="operator">(</span>ans<span class="operator">));</span>
    ans<span class="operator">[</span><span class="int">0</span><span class="operator">] =</span><span class="int"> 0</span><span class="operator">;</span><span class="flow">
    for</span><span class="operator">(</span><span class="type">int</span> i<span class="operator"> =</span><span class="int"> 1</span><span class="operator">;</span> i<span class="operator"> &lt;=</span> n<span class="operator">;</span> i<span class="operator">++)
    {</span>
        add_letter<span class="operator">(</span>s<span class="operator">[</span>i<span class="operator"> -</span><span class="int"> 1</span><span class="operator">]);</span><span class="flow">
        for</span><span class="operator">(</span><span class="type">int</span> v<span class="operator"> =</span> last<span class="operator">;</span> len<span class="operator">[</span>v<span class="operator">] &gt;</span><span class="int"> 0</span><span class="operator">;</span> v<span class="operator"> =</span> slink<span class="operator">[</span>v<span class="operator">])
        {</span>
            series_ans<span class="operator">[</span>v<span class="operator">] =</span> ans<span class="operator">[</span>i<span class="operator"> - (</span>len<span class="operator">[</span>slink<span class="operator">[</span>v<span class="operator">]] +</span> diff<span class="operator">[</span>v<span class="operator">])];</span><span class="flow">
            if</span><span class="operator">(</span>diff<span class="operator">[</span>v<span class="operator">] ==</span> diff<span class="operator">[</span>link<span class="operator">[</span>v<span class="operator">]])</span>
                series_ans<span class="operator">[</span>v<span class="operator">] =</span> min<span class="operator">(</span>series_ans<span class="operator">[</span>v<span class="operator">],</span> series_ans<span class="operator">[</span>link<span class="operator">[</span>v<span class="operator">]]);</span>
            ans<span class="operator">[</span>i<span class="operator">] =</span> min<span class="operator">(</span>ans<span class="operator">[</span>i<span class="operator">],</span> series_ans<span class="operator">[</span>v<span class="operator">] +</span><span class="int"> 1</span><span class="operator">);
        }</span>
        cout<span class="operator"> &lt;&lt;</span> ans<span class="operator">[</span>i<span class="operator">] &lt;&lt;</span><span class="string"> "\n"</span><span class="operator">;
    }</span><span class="flow">
    return</span><span class="int"> 0</span><span class="operator">;
}</span>
 </pre>


</body></html>
